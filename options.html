<!DOCTYPE html>
<html>
<head>
  <title>Ernesto Settings</title>
  <style>
    body {
      padding: 20px;
      font-family: Arial, sans-serif;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
    }
    .form-group {
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-bottom: 5px;
    }
    input[type="text"] {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
    }
    .help-text {
      font-size: 0.9em;
      color: #666;
      margin-bottom: 10px;
    }
    button {
      padding: 8px 16px;
      margin-right: 10px;
    }
    .section-divider {
      margin: 30px 0 15px;
      border-top: 1px solid #eee;
      padding-top: 15px;
    }
    .danger-button {
      background-color: #f44336;
      color: white;
      border: none;
      cursor: pointer;
    }
    .danger-button:hover {
      background-color: #d32f2f;
    }
    .cache-section {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    .cache-item {
      padding: 15px;
      background: #f5f5f5;
      border-radius: 4px;
    }
    .cache-item p {
      margin-top: 0;
    }
    .color-picker-container {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 15px;
    }
    .color-option {
      display: flex;
      flex-direction: column;
      width: 45%;
    }
    .color-option label {
      font-size: 14px;
      margin-bottom: 5px;
    }
    .color-picker {
      display: flex;
      align-items: center;
    }
    input[type="color"] {
      width: 60px;
      height: 30px;
      border: 1px solid #ccc;
      border-radius: 4px;
      background: none;
      cursor: pointer;
    }
    .color-option-with-sync {
      display: flex;
      flex-direction: column;
      width: 45%;
    }
    .sync-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 5px;
    }
    .sync-button {
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 5px 8px;
      font-size: 12px;
      cursor: pointer;
      white-space: nowrap;
      height: 26px;
      display: flex;
      align-items: center;
    }
    .sync-button:hover {
      background-color: #388E3C;
    }
    .sync-icon {
      width: 14px;
      height: 14px;
      margin-right: 4px;
    }
    .color-label {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .color-name {
      font-size: 14px;
      font-weight: 500;
    }
    .color-description {
      font-size: 12px;
      color: #666;
    }
    .domain-theme-list-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      margin-bottom: 10px;
    }
    .domain-theme-actions button {
      margin-left: 5px;
      font-size: 12px;
      padding: 4px 8px;
    }
    .domain-theme-form {
        margin-top: 20px;
        padding: 15px;
        border: 1px solid #eee;
        border-radius: 4px;
        background-color: #f9f9f9;
    }
    .domain-theme-form h4 {
        margin-top: 0;
    }
    .hidden {
        display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Ernesto Settings</h2>
    <div class="form-group">
      <label for="apiKey">OpenAI API Key</label>
      <input type="text" id="apiKey" placeholder="Enter your OpenAI API key">
      <div class="help-text">
        Get your API key from <a href="https://platform.openai.com/api-keys" target="_blank">OpenAI Platform</a>
      </div>
    </div>
    <button id="save">Save</button>
    <button id="cancel">Cancel</button>
    
    <div class="section-divider">
      <h3>Theme Customization</h3>
      
      <!-- Default Theme Section -->
      <h4>Default Theme</h4>
      <p class="help-text">This theme applies to all websites unless a specific theme is set below.</p>
      <div class="color-picker-container" id="default-theme-pickers">
        <div class="color-option-with-sync">
          <div class="color-label">
            <span class="color-name">Main Accent Color</span>
            <span class="color-description">Primary buttons</span>
          </div>
          <div class="color-picker">
            <input type="color" id="mainAccentColor">
          </div>
          <div class="sync-row">
            <button id="syncColors" class="sync-button">
              <svg class="sync-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M4 12a8 8 0 0 1 8-8v2.5M20 12a8 8 0 0 1-8 8v-2.5"></path>
                <path d="M12 2v4M12 18v4"></path>
              </svg>
              Auto-sync colors
            </button>
            <div class="help-text">Derive other colors from accent</div>
          </div>
        </div>
        <div class="color-option">
          <div class="color-label">
            <span class="color-name">Hover Color</span>
            <span class="color-description">Button hover states</span>
          </div>
          <div class="color-picker">
            <input type="color" id="hoverColor">
          </div>
        </div>
        <div class="color-option">
          <div class="color-label">
            <span class="color-name">Disabled Color</span>
            <span class="color-description">Inactive buttons</span>
          </div>
          <div class="color-picker">
            <input type="color" id="disabledColor">
          </div>
        </div>
        <div class="color-option">
          <div class="color-label">
            <span class="color-name">Summary Background</span>
            <span class="color-description">Summary section</span>
          </div>
          <div class="color-picker">
            <input type="color" id="summaryBgColor">
          </div>
        </div>
      </div>
      <button id="saveDefaultTheme">Save Default Theme</button>
      <button id="resetDefaultTheme">Reset Default Theme</button>

      <!-- Domain Specific Themes Section -->
      <div class="section-divider"></div>
      <h4>Domain Specific Themes</h4>
      <p class="help-text">Set custom themes for specific websites.</p>

      <div id="domain-themes-list">
          <!-- Domain themes will be listed here by options.js -->
      </div>
      
      <div class="domain-theme-form">
          <h4>Add/Edit Domain Theme</h4>
          <div class="form-group">
              <label for="domainName">Domain Name (e.g., example.com)</label>
              <input type="text" id="domainName" placeholder="Enter domain name">
              <input type="hidden" id="editingDomainName">
          </div>
          <div class="color-picker-container" id="domain-theme-pickers">
              <div class="color-option-with-sync">
                  <label for="domainMainAccentColor">Main Accent Color</label>
                  <input type="color" id="domainMainAccentColor">
                  <div class="sync-row">
                      <button id="syncDomainColors" class="sync-button">
                          <svg class="sync-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                              <path d="M4 12a8 8 0 0 1 8-8v2.5M20 12a8 8 0 0 1-8 8v-2.5"></path>
                              <path d="M12 2v4M12 18v4"></path>
                          </svg>
                          Auto-sync colors
                      </button>
                      <div class="help-text">Derive other colors from accent</div>
                  </div>
              </div>
              <div class="color-option">
                  <label for="domainHoverColor">Hover Color</label>
                  <input type="color" id="domainHoverColor">
              </div>
              <div class="color-option">
                  <label for="domainDisabledColor">Disabled Color</label>
                  <input type="color" id="domainDisabledColor">
              </div>
              <div class="color-option">
                  <label for="domainSummaryBgColor">Summary Background</label>
                  <input type="color" id="domainSummaryBgColor">
              </div>
          </div>
          <button id="saveDomainTheme">Save Domain Theme</button>
          <button id="cancelEditDomainTheme" class="hidden">Cancel Edit</button>
      </div>

    </div>
    
    <div class="section-divider">
      <h3>Cache Management</h3>
      <div class="cache-section">
        <div class="cache-item">
          <p>Clear all cached summaries to force fresh summaries on next request.</p>
          <p>Current size: <span id="summariesSize">0 B</span></p>
          <button id="purgeCache" class="danger-button">Purge Summaries Cache</button>
          <span id="purgeStatus"></span>
        </div>
        <div class="cache-item">
          <p>Clear all cached audio files to force fresh audio generation on next request.</p>
          <p>Current size: <span id="audioSize">0 B</span></p>
          <button id="purgeAudioCache" class="danger-button">Purge Audio Cache</button>
          <span id="purgeAudioStatus"></span>
        </div>
        <div class="cache-item">
          <p>Clear all cached prompt responses to start fresh conversations.</p>
          <p>Current size: <span id="promptsSize">0 B</span></p>
          <button id="purgePromptsCache" class="danger-button">Purge Prompts Cache</button>
          <span id="purgePromptsStatus"></span>
        </div>
      </div>
    </div>
  </div>
  <script type="module" src="options.js"></script>
</body>
</html> 